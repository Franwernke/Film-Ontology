## Prefixos utilizados ##

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX ep1: <http://www.semanticweb.org/cora/ontologies/2021/10/filmes#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

## Consulta 1 ##

SELECT ?filme ?titulo
  WHERE {
    ep1:joel_coen ep1:dirigeEm ?filme.
    ?filme ep1:temTitulo ?titulo.
  } ORDER BY ASC(?titulo)

## Consulta 2 ##

SELECT ?PrimeiroNome ?UltimoNome ?Personagem
  WHERE {
	  ?filme ep1:temTitulo "Anna".
    ?ator ep1:atuaEm ?filme.
    ?ator foaf:firstName ?PrimeiroNome.
    ?ator foaf:familyName ?UltimoNome.
    ?personagem ep1:ehInterpretadoPor ?ator.
    ?personagem ep1:ehPersonagemDe ?filme.
    ?personagem ep1:temNome ?Personagem.
  } ORDER BY ASC(?ator)

## Consulta 3 ##

SELECT ?filme ?diretor ?AnoDeLancamento
  WHERE {
      ep1:scarlett_johansson ep1:atuaEm ?filme.
      ep1:joaquin_phoenix ep1:atuaEm ?filme.
      ?diretor ep1:dirigeEm ?filme.
      ?filme ep1:temAnoDeLancamento ?AnoDeLancamento.
  } ORDER BY DESC(?AnoDeLancamento)

## Consulta 4 ##

SELECT DISTINCT ?filme ?Duracao
  WHERE {
      ?diretor ep1:dirigeEm ep1:barton_fink.
      ?diretor ep1:dirigeEm ?filme.
      { ep1:ted_raimi ep1:atuaEm ?filme. }
        UNION
      { ep1:john_goodman ep1:atuaEm ?filme. }
      ?filme ep1:temDuracao ?Duracao.
  } ORDER BY DESC(?Duracao)

## Consulta 5 ##

SELECT DISTINCT ?Pessoa
  WHERE {
    ?Pessoa ep1:atuaEm ?a.
    ?Pessoa ep1:dirigeEm ?b.
  }

## Consulta 6 ##

SELECT ?diretor ?filme ?ano
  WHERE {
    ?diretor ep1:dirigeEm ?filme.
    ?filme ep1:temAnoDeLancamento ?ano.
    ep1:scarlett_johansson ep1:atuaEm ?filme.
    ep1:joaquin_phoenix ep1:atuaEm ?filme.
    FILTER (2013 <= ?ano && ?ano <= 2013)
  } ORDER BY ASC(?ano)

## Consulta 7 ##

SELECT ?atriz ?ator ?filme ?duracao
  WHERE {
    ?atriz ep1:atuaEm ?filme.
    ?ator ep1:atuaEm ?filme.
    ?atriz foaf:gender "feminino"^^xsd:string.
    ?ator foaf:gender "masculino"^^xsd:string.
    ?filme ep1:temDuracao ?duracao.
    FILTER (121 <= ?duracao && ?duracao <= 121)
  }

## Consulta 8 ##

SELECT ?diretor
  WHERE {
    ?ator foaf:firstName "Scarlett"^^xsd:string.
    ?ator foaf:familyName "Johansson"^^xsd:string.
    ?ator ep1:atuaEm ?filme.
    ?diretor ep1:dirigeEm ?filme.
  }
  GROUP BY ?diretor
  ORDER BY DESC(COUNT(?diretor))
  LIMIT 1

## Consulta 9 ##

SELECT ?filme ?nomePersonagem ?anoDeLancamento
  WHERE {
    ep1:tim_blake_nelson ep1:atuaEm ?filme; ep1:interpretaEm ?personagem.
    
    ?personagem ep1:ehPersonagemDe ?filme; ep1:temNome ?nomePersonagem.
    
    ?filme ep1:temAnoDeLancamento ?anoDeLancamento.
    {
      SELECT (MIN(?anoDeLancamento) AS ?minimoAnoDeLancamento)
        WHERE {
          ep1:tim_blake_nelson ep1:atuaEm ?filme.
          ?filme ep1:temAnoDeLancamento ?anoDeLancamento.
      } GROUP BY (ep1:tim_blake_nelson)
    }.
    FILTER(?anoDeLancamento = ?minimoAnoDeLancamento)
  } ORDER BY ASC(?anoDeLancamento)

## Consulta 10 ##

SELECT ?filme ?duracao
  WHERE {
    ep1:joel_coen ep1:dirigeEm ?filme.
    ?filme ep1:temDuracao ?duracao.
    {
      SELECT (MAX(?duracao) AS ?maxDuracao)
        WHERE {
          ep1:joel_coen ep1:dirigeEm ?filme.
          ?filme ep1:temDuracao ?duracao.
        } GROUP BY (ep1:joel_coen)
    }
    FILTER(?duracao = ?maxDuracao)
  } ORDER BY ASC(?anoDeLancamento)